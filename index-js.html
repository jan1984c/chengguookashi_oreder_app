  <script>
  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('select');
    var instances = M.FormSelect.init(elems);
  });

document.getElementById("coupon").addEventListener("input",couponCheck);
document.getElementById("btn_1").addEventListener("click",addToCal);
document.getElementById("btn_2").addEventListener("click",addToCal);
document.getElementById("btn_3").addEventListener("click",addToCal);

  var done = document.getElementById("icon_done");
  var error = document.getElementById("icon_error");
  var loop = document.getElementById("icon_loop");
  var local_offer = document.getElementById("icon_local_offer");

  done.style.display = "none";
  error.style.display = "none";
  loop.style.display = "none";

function couponCheck(){
  var coupon_number = document.getElementById("coupon").value;

  local_offer.style.display = "none";
  loop.style.display = "block";

  if (coupon_number.length === 5){
    google.script.run.withSuccessHandler(coupon_result).couponcheck(coupon_number);

  } else if (coupon_number.length === 0){
      loop.style.display = "none";
      local_offer.style.display = "block";
  } else{
    document.getElementById("test").innerHTML = "Ready";
    M.updateTextFields();
      done.style.display = "none";
      error.style.display = "none";
      loop.style.display = "block";
      local_offer.style.display = "none";

  }
}

function coupon_result(result){

    // document.getElementById("test").innerHTML = result;
    M.updateTextFields();

    if (result === "OK"){
        error.style.display = "none";
        loop.style.display = "none";
        done.style.display = "block";
    } else{
        done.style.display = "none";
        loop.style.display = "none";
        error.style.display = "block";
    }

  }

function addToCal(){

  var info = {};
  info.name_1 = document.getElementById("name_1").innerText;
  info.pri_1 = document.getElementById("pri_1").innerText.replace("價格","");
  info.qun_1 = document.getElementById("qun_1").value;
  
  info.name_2 = document.getElementById("name_2").innerText;
  info.pri_2 = document.getElementById("pri_2").innerText.replace("價格","");
  info.qun_2 = document.getElementById("qun_2").value;

  info.name_3 = document.getElementById("name_3").innerText;
  info.pri_3 = document.getElementById("pri_3").innerText.replace("價格","");
  info.qun_3 = document.getElementById("qun_3").value;

  google.script.run.withSuccessHandler(showResult).calculate(info);

}

function showResult(result){
  document.getElementById('calResult').textContent = result;
}

  </script>